<!DOCTYPE html>
<html>
<head>
  <title>Restaurant Inspection Scores</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <style>
    /* Center the search section */
    #search {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .search-container {
      margin-top: 10px;
    }

    #searchInput {
      width: 300px;
      padding: 5px;
      margin-right: 5px;
    }

    #searchButton {
      padding: 5px 10px;
    }

    #searchResults {
      list-style-type: none;
      padding: 0;
      margin-top: 10px;
      text-align: left;
    }
  </style>
</head>
<body>
  <header>
    <h1>Restaurant Inspection Scores</h1>
  </header>
  
  <section id="search">
    <h2>Search Restaurants</h2>
    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Search by restaurant name">
      <button id="searchButton">Search</button>
    </div>
    <ul id="searchResults"></ul>
  </section>
  
  <main>
    <section id="top10">
      <h2>Top 10 Restaurants</h2>
      <canvas id="topChart"></canvas>
    </section>
    
    <section id="worst10">
      <h2>Worst 10 Restaurants</h2>
      <canvas id="worstChart"></canvas>
    </section>
  </main>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize the restaurants array
      var restaurants = [];

      // Function to process the retrieved data from the Python script
      function processData(data) {
        // Parse the JSON data
        var processedData = JSON.parse(data);

        // Update the restaurants array with the processed data
        restaurants = processedData;

        // Sort the restaurants based on scores in descending order
        restaurants.sort(function(a, b) {
          return b.score - a.score;
        });

        // Create the chart for the top 10 restaurants
        var topScores = restaurants.slice(0, 10).map(function(restaurant) {
          return restaurant.score;
        });

        var topLabels = restaurants.slice(0, 10).map(function(restaurant) {
          return restaurant.EstablishmentName;
        });

        var topChartCtx = document.getElementById('topChart').getContext('2d');
        var topChart = new Chart(topChartCtx, {
          type: 'bar',
          data: {
            labels: topLabels,
            datasets: [{
              label: 'Scores',
              data: topScores,
              backgroundColor: '#FF9800',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                title: {
                  display: true,
                  text: 'Scores'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Restaurants'
                }
              }
            }
          }
        });

        // Create the chart for the worst 10 restaurants
        var worstScores = restaurants.slice(-10).map(function(restaurant) {
          return restaurant.score;
        });

        var worstLabels = restaurants.slice(-10).map(function(restaurant) {
          return restaurant.EstablishmentName;
        });

        var worstChartCtx = document.getElementById('worstChart').getContext('2d');
        var worstChart = new Chart(worstChartCtx, {
          type: 'bar',
          data: {
            labels: worstLabels,
            datasets: [{
              label: 'Scores',
              data: worstScores,
              backgroundColor: '#FF9800',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                title: {
                  display: true,
                  text: 'Scores'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Restaurants'
                }
              }
            }
          }
        });

        // Rest of the JavaScript code...
        // ...
        // ...
      }

      // Function to make the AJAX request to fetch the processed data from the Python script
      function fetchData() {
        // Make the AJAX request
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var data = xhr.responseText; // Get the content of the processed_data.json file
            processData(data); // Pass the data to the processData function
          }
        };
        xhr.open('GET', 'processed_data.json', true); // Replace with the path to your processed data file
        xhr.send();
      }

      // Call the fetchData function to retrieve the processed data and create the charts
      fetchData();

      // Rest of the JavaScript code...
      // ...
      // ...
    });
  </script>
</body>
</html>
